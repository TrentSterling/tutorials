<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamedev Hub | Tront</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.0/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Fira+Code:wght@400;500&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
        }

        .prose pre {
            background-color: #1e293b !important;
            border: 1px solid #334155;
            border-radius: 0.5rem;
        }

        .prose code {
            font-family: 'Fira Code', monospace;
            color: #38bdf8;
        }

        .prose h1 { color: #f8fafc; font-weight: 700; border-bottom: 1px solid #334155; padding-bottom: 0.5rem; }
        .prose h2 { color: #f1f5f9; font-weight: 600; margin-top: 2rem; }
        .prose a { color: #38bdf8; text-decoration: none; }
        .prose a:hover { text-decoration: underline; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        .nav-item.active {
            background-color: #1e293b;
            border-left: 4px solid #38bdf8;
            color: #38bdf8;
        }
    </style>
</head>
<body class="flex h-screen overflow-hidden">

    <!-- Sidebar -->
    <aside class="w-72 bg-slate-900 border-r border-slate-800 flex flex-col">
        <div class="p-6">
            <h1 class="text-xl font-bold tracking-tight text-white flex items-center gap-2">
                <span class="text-sky-500">ðŸŽ®</span> Gamedev Hub
            </h1>
            <p class="text-[10px] text-slate-500 uppercase tracking-widest mt-1">Tront Technical Series</p>
        </div>
        <nav class="flex-1 overflow-y-auto p-4 space-y-6" id="sidebar-nav">
            <!-- Sections will be injected here -->
        </nav>
        <div class="p-4 border-t border-slate-800 text-[10px] text-slate-500">
            v1.1.0 &bull; 40+ Topics Scaffolding
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto bg-slate-950 p-8 lg:p-12">
        <div class="max-w-4xl mx-auto">
            <!-- Demo Container -->
            <div id="demo-wrapper" class="hidden mb-8 bg-slate-900 border border-slate-800 rounded-xl overflow-hidden shadow-2xl">
                <div class="px-4 py-2 border-b border-slate-800 bg-slate-900/50 flex justify-between items-center">
                    <span class="text-xs font-bold text-slate-500 uppercase tracking-widest">Interactive Demo</span>
                    <span class="text-[10px] text-slate-600">Canvas2D / JS</span>
                </div>
                <canvas id="demo-canvas" class="w-full h-[300px] cursor-crosshair"></canvas>
            </div>

            <div id="content" class="prose prose-invert prose-sky max-w-none">
                <div class="flex items-center justify-center h-64 text-slate-500">
                    <p class="text-lg animate-pulse">Select a tutorial to begin...</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        const categories = [
            {
                name: "Foundational Math & Physics",
                items: [
                    { id: 'frim', name: 'FRIM (Lerp Smoothing)' },
                    { id: 'sat', name: 'SAT Collision' },
                    { id: 'verlet', name: 'Verlet Integration' },
                    { id: 'pid-controllers', name: 'PID Controllers' },
                    { id: 'fast-math-hacks', name: 'Fast Math Hacks' },
                    { id: 'gjk-collision', name: 'GJK Algorithm' },
                    { id: 'pbd-physics', name: 'PBD (Position Based Dynamics)' },
                    { id: 'buoyancy-sph', name: 'Buoyancy & Fluids' },
                    { id: 'raycast-vehicles', name: 'Raycast Vehicle Physics' }
                ]
            },
            {
                name: "AI & Pathfinding",
                items: [
                    { id: 'astar', name: 'A* Pathfinding' },
                    { id: 'navmesh', name: 'Navmesh & Funnel' },
                    { id: 'behavior-trees', name: 'Behavior Trees' },
                    { id: 'goap-ai', name: 'GOAP Planning' },
                    { id: 'utility-ai', name: 'Utility AI' },
                    { id: 'boids', name: 'Boids Flocking' },
                    { id: 'platformer-pathfinding', name: 'Platformer Pathfinding' }
                ]
            },
            {
                name: "Engine Architecture",
                items: [
                    { id: 'ecs', name: 'ECS Architecture' },
                    { id: 'threading', name: 'Task-Based Threading' },
                    { id: 'spatial-hash', name: 'Spatial Hashing' },
                    { id: 'scene-graphs', name: 'Scene Graphs' },
                    { id: 'asset-pipelines', name: 'Asset Pipelines' },
                    { id: 'timestep-logic', name: 'Timestep Logic' },
                    { id: 'memory-allocators', name: 'Custom Allocators' }
                ]
            },
            {
                name: "Graphics & Visuals",
                items: [
                    { id: 'voxel-gi', name: 'Voxel Global Illumination' },
                    { id: 'pbr', name: 'PBR Shading' },
                    { id: 'sdf-rendering', name: 'SDF Rendering' },
                    { id: 'volumetric-lighting', name: 'Volumetric Beams' },
                    { id: 'shadow-mapping', name: 'Shadow Mapping' },
                    { id: 'skeletal-animation', name: 'Skeletal Animation' },
                    { id: 'bsp', name: 'BSP Trees' },
                    { id: 'radix-sort', name: 'Radix Sort (GPU)' },
                    { id: 'dual-contouring', name: 'Dual Contouring' },
                    { id: 'wfc-procedural', name: 'Wave Function Collapse' }
                ]
            },
            {
                name: "VR & Specialized Systems",
                items: [
                    { id: 'vr-physics-hands', name: 'VR Physics & Climbing' },
                    { id: 'ik', name: 'Inverse Kinematics (FABRIK)' }
                ]
            },
            {
                name: "Networking",
                items: [
                    { id: 'networking', name: 'Prediction & Reconciliation' },
                    { id: 'lag-compensation', name: 'Lag Compensation' },
                    { id: 'delta-compression', name: 'Delta Compression' }
                ]
            },
            {
                name: "Tooling",
                items: [
                    { id: 'frame-profiling', name: 'Frame Profiling' },
                    { id: 'disk-visualizers', name: 'Disk Space Visualizers' },
                    { id: 'llm-integration', name: 'LLM Integration' }
                ]
            }
        ];

        const sidebarNav = document.getElementById('sidebar-nav');
        const contentDiv = document.getElementById('content');

        function initSidebar() {
            sidebarNav.innerHTML = categories.map(cat => `
                <div>
                    <h3 class="px-4 text-[11px] font-bold text-slate-500 uppercase tracking-widest mb-2">${cat.name}</h3>
                    <div class="space-y-1">
                        ${cat.items.map(t => `
                            <a href="#${t.id}" 
                               class="nav-item block px-4 py-1.5 text-sm rounded-lg text-slate-400 hover:bg-slate-800 hover:text-white transition-colors"
                               id="nav-${t.id}">
                                ${t.name}
                            </a>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        let currentDemo = null;

        async function loadTutorial(id) {
            // Clean up previous demo
            if (currentDemo && currentDemo.destroy) currentDemo.destroy();
            document.getElementById('demo-wrapper').classList.add('hidden');
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            const activeNav = document.getElementById(`nav-${id}`);
            if (activeNav) activeNav.classList.add('active');

            try {
                // Load Markdown
                const response = await fetch(`${id}/README.md`);
                if (!response.ok) throw new Error('Failed to load');
                const text = await response.text();
                
                contentDiv.innerHTML = marked.parse(text);
                contentDiv.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightElement(block);
                });
                document.querySelector('main').scrollTop = 0;

                // Load Demo JS if exists
                try {
                    const demoResponse = await fetch(`${id}/demo.js`);
                    if (demoResponse.ok) {
                        const demoCode = await demoResponse.text();
                        const canvas = document.getElementById('demo-canvas');
                        const wrapper = document.getElementById('demo-wrapper');
                        
                        wrapper.classList.remove('hidden');
                        
                        // Execute demo code in a scoped way
                        const demoFunc = new Function('canvas', demoCode);
                        currentDemo = demoFunc(canvas);
                    }
                } catch (e) { /* No demo found */ }

            } catch (err) {
                contentDiv.innerHTML = `<div class="p-8 text-center text-slate-500 border border-dashed border-slate-800 rounded-xl">
                    <h2 class="text-xl font-bold text-slate-400">Content TBD</h2>
                    <p class="mt-2 italic">The tutorial for "${id}" is currently in the scaffold phase.</p>
                </div>`;
            }
        }

        window.addEventListener('hashchange', () => {
            const id = window.location.hash.slice(1);
            if (id) loadTutorial(id);
        });

        initSidebar();
        const initialId = window.location.hash.slice(1);
        if (initialId) loadTutorial(initialId);
    </script>
</body>
</html>
